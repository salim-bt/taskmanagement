<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{fragments/head :: head('Task')}" />
<body class="bg-surface-0 font-sans text-text-primary min-h-screen" x-data>

	<!-- Authenticated: sidebar layout -->
	<template x-if="$store.auth.user">
		<div>
			<!-- Skip link -->
			<a href="#dashboard-main" class="skip-link">Skip to content</a>

			<th:block th:replace="~{fragments/sidebar :: sidebar}" />
			<th:block th:replace="~{fragments/command-palette :: commandPalette}" />

			<div class="lg:pl-[240px] min-h-screen">
				<!-- Top bar -->
				<header class="sticky top-0 z-30 h-14 bg-surface-0/80 backdrop-blur-md border-b border-border-subtle flex items-center px-6 gap-4">
					<button @click="$store.sidebar.toggleMobile()" class="lg:hidden text-text-secondary hover:text-text-primary transition-colors" aria-label="Open menu">
						<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
					</button>
					<h1 class="text-base font-semibold text-text-primary">Home</h1>
				</header>

				<main id="dashboard-main" class="p-8 max-w-4xl" role="main">
					<!-- Welcome with time-of-day greeting -->
					<div class="mb-8">
						<h2 id="dashboardGreeting" class="text-lg font-semibold text-text-primary">Good to see you</h2>
						<p class="text-sm text-text-tertiary mt-1">Here's what's happening in your workspace.</p>
					</div>

					<!-- Progress overview -->
					<div id="progressSection" class="mb-8 bg-surface-2 border border-border rounded-xl p-5 hidden">
						<div class="flex items-center justify-between mb-3">
							<span class="text-sm font-medium text-text-secondary">Overall Progress</span>
							<span id="progressPercent" class="text-sm font-semibold text-accent">0%</span>
						</div>
						<div class="progress-bar">
							<div id="progressFill" class="progress-bar-fill" style="width: 0%"></div>
						</div>
						<div class="flex items-center justify-between mt-2">
							<span class="text-xs text-text-tertiary"><span id="progressDone">0</span> of <span id="progressTotal">0</span> tasks completed</span>
							<span id="progressLabel" class="text-xs text-text-tertiary"></span>
						</div>
					</div>

					<!-- Stats grid -->
					<div id="dashboardStats" class="grid grid-cols-2 sm:grid-cols-5 gap-4 mb-10">
						<div class="stat-card bg-surface-2 border border-border rounded-xl px-5 py-4 cursor-default">
							<p class="text-xs text-text-tertiary font-medium uppercase tracking-wider">Total</p>
							<p id="statTotal" class="text-2xl font-semibold text-text-primary mt-2">--</p>
						</div>
						<a href="/ui/tasks" class="stat-card bg-surface-2 border border-border rounded-xl px-5 py-4 no-underline block">
							<div class="flex items-center gap-2">
								<span class="w-2.5 h-2.5 rounded-full status-dot-TODO" aria-hidden="true"></span>
								<p class="text-xs text-text-tertiary font-medium uppercase tracking-wider">Todo</p>
							</div>
							<p id="statTodo" class="text-2xl font-semibold text-text-primary mt-2">--</p>
						</a>
						<a href="/ui/tasks" class="stat-card bg-surface-2 border border-border rounded-xl px-5 py-4 no-underline block">
							<div class="flex items-center gap-2">
								<span class="w-2.5 h-2.5 rounded-full status-dot-DOING" aria-hidden="true"></span>
								<p class="text-xs text-text-tertiary font-medium uppercase tracking-wider">In Progress</p>
							</div>
							<p id="statDoing" class="text-2xl font-semibold text-text-primary mt-2">--</p>
						</a>
						<a href="/ui/tasks" class="stat-card bg-surface-2 border border-border rounded-xl px-5 py-4 no-underline block">
							<div class="flex items-center gap-2">
								<span class="w-2.5 h-2.5 rounded-full status-dot-DONE" aria-hidden="true"></span>
								<p class="text-xs text-text-tertiary font-medium uppercase tracking-wider">Done</p>
							</div>
							<p id="statDone" class="text-2xl font-semibold text-text-primary mt-2">--</p>
						</a>
						<div class="stat-card bg-surface-2 border border-border rounded-xl px-5 py-4 cursor-default">
							<p class="text-xs text-text-tertiary font-medium uppercase tracking-wider">My Tasks</p>
							<p id="statMine" class="text-2xl font-semibold text-accent mt-2">--</p>
						</div>
					</div>

					<!-- Quick actions -->
					<div class="flex items-center gap-3 mb-8 flex-wrap">
						<a href="/ui/tasks" class="inline-flex items-center gap-2 px-4 py-2 bg-accent text-white text-sm font-medium rounded-lg hover:bg-accent-hover transition-colors">
							<svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
							View Tasks
						</a>
						<button @click="$store.cmd.toggle()" class="inline-flex items-center gap-2 px-4 py-2 bg-surface-3 text-text-secondary text-sm font-medium rounded-lg border border-border hover:bg-surface-4 hover:text-text-primary transition-colors cursor-pointer">
							<svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
							Search
							<kbd class="ml-1 kbd-hint">&lceil;K</kbd>
						</button>
					</div>

					<!-- Recent activity -->
					<div>
						<h3 class="text-sm font-medium text-text-secondary mb-3">Recent activity</h3>
						<div id="recentActivity" class="bg-surface-2 border border-border rounded-lg overflow-hidden" role="list" aria-label="Recent activity">
							<!-- Skeleton -->
							<div class="animate-pulse space-y-0">
								<div class="flex items-center gap-3 px-3 py-3 border-b border-border-subtle"><div class="w-1.5 h-1.5 bg-surface-5 rounded-full"></div><div class="h-3 bg-surface-4 rounded w-3/4"></div><div class="h-2 bg-surface-3 rounded w-12 ml-auto"></div></div>
								<div class="flex items-center gap-3 px-3 py-3 border-b border-border-subtle"><div class="w-1.5 h-1.5 bg-surface-5 rounded-full"></div><div class="h-3 bg-surface-4 rounded w-2/3"></div><div class="h-2 bg-surface-3 rounded w-12 ml-auto"></div></div>
								<div class="flex items-center gap-3 px-3 py-3"><div class="w-1.5 h-1.5 bg-surface-5 rounded-full"></div><div class="h-3 bg-surface-4 rounded w-1/2"></div><div class="h-2 bg-surface-3 rounded w-12 ml-auto"></div></div>
							</div>
						</div>
					</div>
				</main>
			</div>
		</div>
	</template>

	<!-- Unauthenticated: minimal landing -->
	<template x-if="!$store.auth.user">
		<div class="min-h-screen flex flex-col items-center justify-center px-4 text-center" role="main">
			<div class="w-12 h-12 bg-accent rounded-xl flex items-center justify-center mb-6">
				<svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
			</div>
			<h1 class="text-3xl font-bold tracking-tight mb-3">Task</h1>
			<p class="text-text-tertiary text-sm max-w-md mb-8">Manage work with precision. Kanban boards, role-based access, and full audit trails.</p>
			<div class="flex gap-3">
				<a href="/ui/login" class="inline-flex items-center px-6 py-2.5 bg-accent text-white text-sm font-semibold rounded-lg hover:bg-accent-hover transition-colors">
					Get started
					<svg class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/></svg>
				</a>
			</div>
			<div class="flex gap-6 mt-12 text-[11px] text-text-tertiary flex-wrap justify-center">
				<span class="flex items-center gap-1.5">
					<svg class="w-3.5 h-3.5 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
					Kanban board
				</span>
				<span class="flex items-center gap-1.5">
					<svg class="w-3.5 h-3.5 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
					Role-based access
				</span>
				<span class="flex items-center gap-1.5">
					<svg class="w-3.5 h-3.5 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
					Audit trail
				</span>
			</div>
		</div>
	</template>

	<script src="/assets/ui.js"></script>
</body>
</html>
